<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, target-densitydpi=device-dpi">
  <meta name="renderer" content="webkit">
  <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  
  <title>FGO Servant</title>

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2246f09bef1daa9c8bcc3ddec3239f8e";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  
  
  <!-- <link rel="stylesheet" type="text/css" href="static/css/layout.css"> -->
  <style type="text/css">
    /* Layout */
    html, body {
      overflow:hidden;
      overflow-y:auto;
      overflow-x:hidden;
    }

    body {
      margin: 0;
      padding: 0;
    }

    a, 
    a:hover,
    a:link,
    a:active,
    a:visited
     {
      text-decoration : none;
    } 

    .flex-container {
      display: flex;
      flex-flow: row wrap;
      justify-content: flex-start;

      margin: 50px;
    }
    /* Layout */

    html {
      max-width: 95vw;
    }

    .heads {
      width: 70%;
      margin: auto;
      margin-top: 30px;
    }
    .head img{
      width: 97px;
      height: 106px;
      margin: 10px 15px;
    }
    .word {
      width: 10vh;
    }
    .level-needs {
      list-style-type: none;
    }

    .thumb {
      width: 5.0vw;   /* 50px */
      height: 5.5vw;  /* 55px */
      margin-top: .5vw;
    }
    .thumb.servant {
      margin-top: 0;
    }
    .thumb.skill {
      width: 2.5vw;   /* 25px */
      height: 2.5vw;  /* 25px */
      position: relative;
      top: -2px;
    }

    .material-wrapper {
      display: inline-block;
      width: 8.5vw; /* 85px */
      font-weight: bold;
    }

    .total > .word {
      margin-right: 40px;
    }

    .materials, .level-need {
      width: 40vw;
      display: flex;
      flex-flow: row wrap;
      justify-content: flex-start;

    }

    .materials.calc-result {
      width: 50vw;
    }

    .nav-tabs.servant-classes {
      margin: 20px 0 0 0;
    }

    .summation {
      margin-top: 15px;
    }

    .tbl_servant{
      display: none;
    }


    input[type=number] {
      width: 5vw;
    }

    td span {
      position: relative;
      display: inline-block;
      top: 1px;
      left: 2px;
    }

    .glyphicon-play {
      margin-left: -5px;
    }

    .skill-input {
      display: inline-block; 
      transform: translateX(-10vw);
      margin-top: .5vw;
    }

    .level-input{
      display: inline-block; 
      margin-top: .5vw;
    }


    .skill-group {
      display: flex; 
      flex-flow: row wrap; 
      justify-content: space-between;
    }

    .skill-info, .skill-input, .level-input{
      display: inline-block;
    }

    .item.thumb + span {
      position: relative;
      top: 2vw;
    }
    
    .material-wrapper a + span {
      position: relative;
      top: 2vw;
    }


    @media screen and (max-width:  450px) {
      .flex-container{
        margin: 20px 10px;
      }

      .head img{
        width: 55px;
        height: 60px;
        margin: 4px 10px;
      }
      .heads {
        width: 90%;
      }
      .materials, .level-need {
        width: 320px;
      }
      .materials {
        margin-left: 12vw;
      }


    }

    @media screen and (max-width:  510px) {
      .flex-container{
        margin: 20px 10px;
      }
      input[type=number] {
        width: 25px;
      }
    }

    @media screen and (max-width:  1000px) {
      .thumb {
        width: 50px;   /* 50px */
        height: 55px;  /* 55px */
      }
      .thumb.skill {
        width: 25px;   /* 25px */
        height: 25px;  /* 25px */
      }

      .material-wrapper {
        display: inline-block;
        width: 85px; /* 85px */
        font-weight: bold;
      }

      .skill-input {
        margin-top: 3px;
      }

      .skill-input {
        transform: translateX(-.5vw);
      }

      .mobile-forbidden {
        display: none;
      }
    }

  </style>


</head>
<body>
  
  <ul class="nav nav-tabs">
    <li class="nav-tab item"><a href="item.html">Items</a></li>
    <li class="nav-tab servant"><a href="servant.html">Servants</a></li>
    <li class="nav-tab drop"><a href="drop.html">Drops</a></li>
  </ul>

  <div id="content">
    
    <p><button class="btn btn-default summation mobile-forbidden" data-toggle="button">Summation Mode</button></p>
    

    <ul class="nav nav-tabs servant-classes">
        <li class="nav-tab servant-class Saber">
          <a href="#" data-toggle="tab" data-target='#Saber'>Saber</a>
        </li>
        <li class="nav-tab servant-class Lancer">
          <a href="#" data-toggle="tab" data-target='#Lancer'>Lancer</a>
        </li>
        <li class="nav-tab servant-class Archer">
          <a href="#" data-toggle="tab" data-target='#Archer'>Archer</a>
        </li>
        <li class="nav-tab servant-class Rider">
          <a href="#" data-toggle="tab" data-target='#Rider'>Rider</a>
        </li>
        <li class="nav-tab servant-class Caster">
          <a href="#" data-toggle="tab" data-target='#Caster'>Caster</a>
        </li>
        <li class="nav-tab servant-class Assassin">
          <a href="#" data-toggle="tab" data-target='#Assassin'>Assassin</a>
        </li>
        <li class="nav-tab servant-class Berserker">
          <a href="#" data-toggle="tab" data-target='#Berserker'>Berserker</a>
        </li>
        <li class="nav-tab servant-class Ruler">
          <a href="#" data-toggle="tab" data-target='#Ruler'>Ruler</a>
        </li>
        <li class="nav-tab servant-class Avenger">
          <a href="#" data-toggle="tab" data-target='#Avenger'>Avenger</a>
        </li>
        <li class="nav-tab servant-class Shielder">
          <a href="#" data-toggle="tab" data-target='#Shielder'>Shielder</a>
        </li>
        <li class="nav-tab servant-class Alterego">
          <a href="#" data-toggle="tab" data-target='#Alterego'>Alterego</a>
        </li>
        <li class="nav-tab servant-class MoonCancer">
          <a href="#" data-toggle="tab" data-target='#MoonCancer'>MoonCancer</a>
        </li>
        <li class="nav-tab servant-class Foreigner">
          <a href="#" data-toggle="tab" data-target='#Foreigner'>Foreigner</a>
        </li>
    </ul>

    <div class="tab-content servant-classes">
        <div class="tab-pane" id='Saber'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/153.html" data_num="153">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/153.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/091.html" data_num="091">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/091.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/090.html" data_num="090">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/090.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/076.html" data_num="076">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/076.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/068.html" data_num="068">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/068.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/008.html" data_num="008">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/008.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/002.html" data_num="002">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/002.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/160.html" data_num="160">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/160.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/176.html" data_num="176">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/176.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/165.html" data_num="165">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/165.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/138.html" data_num="138">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/138.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/005.html" data_num="005">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/005.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/004.html" data_num="004">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/004.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/003.html" data_num="003">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/003.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/187.html" data_num="187">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/187.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/123.html" data_num="123">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/123.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/121.html" data_num="121">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/121.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/101.html" data_num="101">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/101.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/010.html" data_num="010">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/010.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/006.html" data_num="006">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/006.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/126.html" data_num="126">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/126.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/072.html" data_num="072">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/072.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/009.html" data_num="009">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/009.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/007.html" data_num="007">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/007.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Lancer'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/128.html" data_num="128">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/128.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/119.html" data_num="119">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/119.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/088.html" data_num="088">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/088.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/070.html" data_num="070">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/070.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/143.html" data_num="143">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/143.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/085.html" data_num="085">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/085.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/193.html" data_num="193">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/193.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/183.html" data_num="183">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/183.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/181.html" data_num="181">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/181.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/146.html" data_num="146">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/146.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/141.html" data_num="141">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/141.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/134.html" data_num="134">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/134.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/078.html" data_num="078">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/078.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/018.html" data_num="018">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/018.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/140.html" data_num="140">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/140.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/102.html" data_num="102">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/102.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/087.html" data_num="087">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/087.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/148.html" data_num="148">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/148.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/186.html" data_num="186">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/186.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/071.html" data_num="071">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/071.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/064.html" data_num="064">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/064.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/022.html" data_num="022">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/022.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/020.html" data_num="020">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/020.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/017.html" data_num="017">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/017.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/021.html" data_num="021">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/021.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/019.html" data_num="019">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/019.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Archer'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/142.html" data_num="142">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/142.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/129.html" data_num="129">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/129.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/156.html" data_num="156">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/156.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/084.html" data_num="084">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/084.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/077.html" data_num="077">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/077.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/060.html" data_num="060">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/060.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/012.html" data_num="012">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/012.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/184.html" data_num="184">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/184.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/180.html" data_num="180">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/180.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/137.html" data_num="137">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/137.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/131.html" data_num="131">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/131.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/069.html" data_num="069">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/069.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/014.html" data_num="014">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/014.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/157.html" data_num="157">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/157.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/122.html" data_num="122">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/122.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/011.html" data_num="011">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/011.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/015.html" data_num="015">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/015.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/125.html" data_num="125">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/125.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/105.html" data_num="105">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/105.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/095.html" data_num="095">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/095.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/063.html" data_num="063">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/063.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/013.html" data_num="013">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/013.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/016.html" data_num="016">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/016.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Rider'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/179.html" data_num="179">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/179.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/144.html" data_num="144">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/144.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/099.html" data_num="099">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/099.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/065.html" data_num="065">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/065.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/118.html" data_num="118">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/118.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/108.html" data_num="108">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/108.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/182.html" data_num="182">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/182.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/132.html" data_num="132">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/132.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/073.html" data_num="073">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/073.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/066.html" data_num="066">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/066.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/030.html" data_num="030">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/030.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/029.html" data_num="029">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/029.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/115.html" data_num="115">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/115.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/094.html" data_num="094">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/094.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/027.html" data_num="027">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/027.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/026.html" data_num="026">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/026.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/023.html" data_num="023">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/023.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/172.html" data_num="172">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/172.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/028.html" data_num="028">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/028.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/025.html" data_num="025">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/025.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/024.html" data_num="024">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/024.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Caster'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/175.html" data_num="175">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/175.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/169.html" data_num="169">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/169.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/136.html" data_num="136">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/136.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/127.html" data_num="127">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/127.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/113.html" data_num="113">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/113.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/062.html" data_num="062">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/062.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/150.html" data_num="150">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/150.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/037.html" data_num="037">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/037.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/194.html" data_num="194">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/194.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/192.html" data_num="192">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/192.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/130.html" data_num="130">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/130.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/120.html" data_num="120">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/120.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/111.html" data_num="111">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/111.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/100.html" data_num="100">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/100.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/074.html" data_num="074">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/074.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/067.html" data_num="067">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/067.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/061.html" data_num="061">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/061.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/145.html" data_num="145">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/145.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/103.html" data_num="103">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/103.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/031.html" data_num="031">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/031.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/104.html" data_num="104">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/104.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/080.html" data_num="080">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/080.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/079.html" data_num="079">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/079.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/038.html" data_num="038">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/038.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/035.html" data_num="035">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/035.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/032.html" data_num="032">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/032.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/034.html" data_num="034">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/034.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/033.html" data_num="033">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/033.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/036.html" data_num="036">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/036.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Assassin'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/189.html" data_num="189">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/189.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/139.html" data_num="139">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/139.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/112.html" data_num="112">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/112.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/086.html" data_num="086">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/086.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/075.html" data_num="075">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/075.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/154.html" data_num="154">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/154.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/188.html" data_num="188">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/188.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/185.html" data_num="185">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/185.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/177.html" data_num="177">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/177.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/170.html" data_num="170">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/170.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/133.html" data_num="133">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/133.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/092.html" data_num="092">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/092.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/046.html" data_num="046">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/046.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/041.html" data_num="041">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/041.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/159.html" data_num="159">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/159.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/109.html" data_num="109">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/109.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/124.html" data_num="124">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/124.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/042.html" data_num="042">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/042.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/117.html" data_num="117">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/117.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/110.html" data_num="110">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/110.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/081.html" data_num="081">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/081.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/044.html" data_num="044">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/044.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/043.html" data_num="043">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/043.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/040.html" data_num="040">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/040.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/045.html" data_num="045">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/045.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/039.html" data_num="039">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/039.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Berserker'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/155.html" data_num="155">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/155.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/114.html" data_num="114">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/114.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/097.html" data_num="097">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/097.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/161.html" data_num="161">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/161.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/098.html" data_num="098">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/098.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/052.html" data_num="052">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/052.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/051.html" data_num="051">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/051.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/178.html" data_num="178">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/178.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/171.html" data_num="171">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/171.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/162.html" data_num="162">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/162.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/116.html" data_num="116">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/116.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/082.html" data_num="082">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/082.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/058.html" data_num="058">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/058.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/089.html" data_num="089">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/089.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/048.html" data_num="048">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/048.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/047.html" data_num="047">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/047.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/056.html" data_num="056">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/056.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/055.html" data_num="055">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/055.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/049.html" data_num="049">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/049.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/057.html" data_num="057">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/057.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/054.html" data_num="054">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/054.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/174.html" data_num="174">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/174.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/053.html" data_num="053">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/053.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/050.html" data_num="050">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/050.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Ruler'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/059.html" data_num="059">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/059.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/173.html" data_num="173">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/173.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/093.html" data_num="093">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/093.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/135.html" data_num="135">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/135.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Avenger'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/106.html" data_num="106">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/106.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/096.html" data_num="096">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/096.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/147.html" data_num="147">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/147.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/158.html" data_num="158">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/158.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/107.html" data_num="107">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/107.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Shielder'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/001.html" data_num="001">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/001.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Alterego'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/167.html" data_num="167">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/167.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/163.html" data_num="163">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/163.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/191.html" data_num="191">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/191.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/190.html" data_num="190">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/190.jpg">
                </a>
              </div>
              <div class="flex-item head">
                <a href="servant/164.html" data_num="164">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/164.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='MoonCancer'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/166.html" data_num="166">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/166.jpg">
                </a>
              </div>
          </div> 

        </div>

        <div class="tab-pane" id='Foreigner'>

          <div class="flex-container heads">
              <div class="flex-item head">
                <a href="servant/195.html" data_num="195">
                  <img src="http://file.fgowiki.fgowiki.com/fgo/head/195.jpg">
                </a>
              </div>
          </div> 

        </div>

    </div>
    
    <table class="table table-striped tbl_servant">
      <colgroup>
        <col style="width:30%;">
        <col style="width:20%;">
        <col style="width:35%;">
        <col style="width:15%;">
      </colgroup>
      <thead>
        <tr>
          <th>Servant</th>
          <th>Level</th>
          <th>Skill</th>
          <th>Operation</th>
        </tr>
      </thead>

      <tbody>

      </tbody>

    </table>
  
    <button class="btn btn-info calc" style="display: none; margin: 0 0 10px 10px;">Calculate</button>

    <div class="total flex-container calc-result" style="display: none;">
      <h3 class="word">total: </h3>
      
      <div class="materials calc-result">
        <!--
        <span class="material-wrapper">
          <img class="item thumb" src="http://file.fgowiki.fgowiki.com/fgo/material/.jpg">
          <span></span>
        </span>
        -->

      </div>

    </div>



 

  </div>

  
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/2.3.1/js/bootstrap-button.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/2.3.1/js/bootstrap-button.js"></script>
    
  

  <script type="text/javascript" charset="utf-8">
    $(document).ready(function(){

      activate_tab()

      $('.servant-class.Saber').addClass('active')
      $('#Saber').addClass('active')

      
      let heads = $('.flex-item.head a');
      let nums = new Array();
      for (let i = 0; i < heads.length; i++) {
        let num = $(heads[i]).attr('data_num');
        nums[i] = num;
      }
      //console.log(nums)
      


      
      let tbl = $('.tbl_servant');
      let trs = $('.tbl_servant tr[data_num]')
      trs.css('display','none')

      let calc = $('.calc')

      let result = $('.total.calc-result')

      $('.summation').on('click', function(){
        heads.toggleClass('sum')
        calc.toggle()
        if ($(heads[0]).hasClass('sum')) {
          heads.attr('href', 'javascript:;')
          tbl.css('display', 'table')
          bind_summation()
          result.show()

        } else {
          for (let i = 0; i < heads.length; i++) {
            $(heads[i]).attr('href', `./servant/${nums[i]}.html`)
          }
          tbl.css('display', 'none')
          //let trs = $('.tbl_servant tr[data_num]')
          //trs.css('display','none')
          heads.off('click')
          result.hide()
        }
      })




      

      calc.on('click', function () {

        let calc_trs = $(`tbody tr`)
        // get level gaps of servants
        let level_pairs = []
        for (let tr of calc_trs) {
          let num = $(tr).attr('data_num')
          let star = $(tr).find('input[data-star]').attr('data-star')
          let texts = $(tr).find(`td:eq(1) input[type='number']`)
          let broken = $(tr).find(`td:eq(1) input[type='checkbox']`).hasClass('checked')
          let level_pair = []
          for (let text of texts) {
            level_pair.push($(text).val())
          }
          let level_pair_b = {
            servant_id: num,
            star: star,
            broken: broken,
            level_pair: level_pair
          }
          level_pairs.push(level_pair_b)
        }
        //console.log(level_pairs)

        let skill_pairs = []
        for (let tr of calc_trs) {
          let num = $(tr).attr('data_num')
          let star = $(tr).find('input[data-star]').attr('data-star')
          let skill_inputs = $(tr).find('td:eq(2) .skill-input')
          let servant_level_pairs = []
          for (let skill_input of skill_inputs) {
            let texts = $(skill_input).find('input')
            let level_pair = []
            for (let text of texts) {
              val = $(text).val()
              level_pair.push(val)
            }
            servant_level_pairs.push(level_pair)
          }
          let servant = {
            servant_id: num,
            servant_skill_pairs: servant_level_pairs,
            star: star
          }
          skill_pairs.push(servant)
        }


        //localStorage.clear()


        //console.log(skill_pairs)
        //$.ajaxSettings.async = false;
        Promise
          .all([get_break_data(), get_together_need(), get_qp_cost(), get_exps_calc()])
          .then(function (result) {
            return data_handler(result)
          })


        function data_handler(result) {
          let [break_data, together_datas, qp_cost, exps_data] = result

          let level_breaks = break_data_handler(break_data)

          set_local_storage('qp_cost', qp_cost)
          set_local_storage('break_data', break_data)
          set_local_storage('exps_data', exps_data)
          set_local_storage('together_datas', together_datas)

          together_data_handler(together_datas, level_breaks)

          exps_handler(exps_data)

          qp_cost_handler(qp_cost, level_breaks)


        }

        function qp_cost_handler (qp_cost, level_breaks) {
          let all_break_need_qp = 0
          for (let level_break of level_breaks) {
            let {breaks, star} = level_break
            let [low, high] = breaks
            let break_need_qp_list = qp_cost['break'][star]
            let break_need_qp = calc_exps(break_need_qp_list, breaks, 1)
            //console.log(break_need_qp)
            all_break_need_qp += break_need_qp
          }
          //console.log(all_break_need_qp)

          let all_skill_need_qp = 0
          for (let skill_pair of skill_pairs) {
            let {servant_skill_pairs, star} = skill_pair
            let skill_need_qp_list = qp_cost['skill'][star]
            for (let servant_skill_pair of servant_skill_pairs) {
              let break_need_qp = calc_exps(skill_need_qp_list, servant_skill_pair, 1)
              all_skill_need_qp += break_need_qp
            }
          }
          //console.log(all_skill_need_qp)

          let all_need_qp = all_break_need_qp + all_skill_need_qp
          all_need_qp = toThousands(all_need_qp)

          let result_div = $('.materials.calc-result')
          let need_qp = $(`<span class="material-wrapper">
                              <img class="item thumb" src="static/images/material/qp.jpg">
                              <span style="position:relative;left:5vw;top:-2vw;">${all_need_qp}</span>
                            </span>`)
          result_div.append(need_qp)
        }

        function break_data_handler (break_data) {
          let level_breaks = []
          for (let level_pair of level_pairs) {
            level_break = level_to_break(level_pair, break_data)
            level_breaks.push(level_break)
          }
          return level_breaks
        }

        function together_data_handler (together_datas, level_breaks) {
          let result_div = $('.materials.calc-result')
          result_div.empty()
          //console.log(together_datas)
          let {data, ordered_ids} = together_datas
          let servants_skill_need = []
          for (let skill_pair of skill_pairs) {
            let {servant_id, servant_skill_pairs} = skill_pair
            let [bs_level_needs, total_needs, total] = data[servant_id]
            let [word, skill_needs] = bs_level_needs[1]
            //console.log(servant_skill_pairs)
            let servant_skill_need = calc_skill_pairs_needs(skill_needs, servant_skill_pairs)
            servants_skill_need.push(servant_skill_need)
          }

          let all_skill_need = servants_skill_need.reduce(push_items_together)
          //console.log(all_skill_need)

          
          let servants_break_need = []
          //console.log(level_breaks)
          for (let level_break of level_breaks) {
            let {servant_id, breaks} = level_break
            //console.log(breaks)
            let [bs_level_needs, total_needs, total] = data[servant_id]
            let [word, break_needs] = bs_level_needs[0]
            let servant_break_need = calc_skill_needs(break_needs, breaks)
            servants_break_need.push(servant_break_need)
          }

          let all_break_need = servants_break_need.reduce(push_items_together)
          //console.log(all_break_need)

          let all_need = push_items_together(all_skill_need, all_break_need)
          //console.log(all_need)
          all_need.sort((x, y) => ordered_ids.indexOf(x[0]) - ordered_ids.indexOf(y[0]))
          
          for (let need of all_need) {
            let need_span = $(`<span class="material-wrapper">
                                <img class="item thumb" src="http://file.fgowiki.fgowiki.com/fgo/material/${need[1]}.jpg">
                                <span>${need[2]}</span>
                              </span>`)
            result_div.append(need_span)
          }
        }

        function exps_handler (data) {
          dog_foods = 0
          for (let servant_level_pair of level_pairs) {
            let {level_pair} = servant_level_pair
            let dog_food = calc_exps(data, level_pair)
            //console.log(calc_exps(data, level_pair))
            dog_foods += dog_food
          }
          let result_div = $('.materials.calc-result')
          let need_food = $(`<span class="material-wrapper">
                              <img class="item thumb" src="static/images/material/dogfood.jpg">
                              <span>${dog_foods}</span>
                            </span>`)
          result_div.append(need_food)
          //console.log(dog_foods)
        }


        function get_qp_cost () {
          let url = './static/json/extra/qp_cost.json'
          let name = 'qp_cost'
          return get_local_storage(name, url)

        }

        function get_break_data () {
          let url = './static/json/extra/star_break_levels.json'
          let name = 'break_data'
          return get_local_storage(name, url)
        }

        function get_together_need () {
          let url = './static/json/servant_need/together_need.json'
          let name = 'together_datas'
          return get_local_storage(name, url)
        }

        function get_exps_calc() {
          let url = './static/json/extra/levelup_exps_calc.json'
          let name = 'exps_data'
          return get_local_storage(name, url)
        }

        //function


      })


    })

    let valid_len_data = {
      'together_datas': 239951
    }

    function get_local_storage(name, url) {
      let local = localStorage[name]
      if (local !== undefined) {
        if ( (name in valid_len_data && local.length === valid_len_data[name]) || !(name in valid_len_data) ){
          return JSON.parse(local)
        }    
      }
      return $.getJSON({
        url: url,
        global: false
      })

    }

    function set_local_storage(name, obj) {
      let local = localStorage[name]
      if (local === undefined || (name in valid_len_data && local.length !== valid_len_data[name])) {
        localStorage[name] = JSON.stringify(obj)
      }
    }

    function toThousands(num) {  
      var num = (num || 0).toString(), result = '';  
      while (num.length > 3) {  
          result = ',' + num.slice(-3) + result;  
          num = num.slice(0, num.length - 3);  
      }  
      if (num) { result = num + result; }  
      return result;  
    }  


    function ajax(param, callback){  
      $.ajax({  
          url:param,  
          type:'get',  
          success:function(data){  
              callback(data);   
          },  
          error:function(data){  
              console.log('error');  
          }         
      })  
    }  

    function request(url){  
      return new Promise(function(resolve,reject){  
          ajax(url,resolve);    
      });  
    }  

    function level_to_break(level_pair_obj, break_levels){
      let {servant_id, star, broken, level_pair} = level_pair_obj
      let break_level = break_levels[star]
      let [low, high] = level_pair
      low = Number(low)
      high = Number(high)

      let breaks = []
      for (let i = 0; i < break_level.length; i++) {
        if (break_level[i] < high && break_level[i] > low) {
          breaks.push(i)
        }
        if (!broken && break_level[i] == low) {
          breaks.push(i)
        }
      }

      if (breaks.length === 0) {
        breaks = [1, 1]
      } else {
        low = Math.min(...breaks)
        high = Math.max(...breaks)  
        breaks = [low+1, high+2]      
      }


      return {
        servant_id: servant_id,
        star: star,
        breaks: breaks,
        broken: broken
      }

    }

    function calc_exps(exps_levels, pair, exp_per_card=32400) {
      let [low, high] = pair
      low = Number(low)
      high = Number(high)
      let exps = 0
      for (let i = low-1; i < high-1; i++) {
        exps += exps_levels[i]
      }
      return Math.ceil(exps/exp_per_card)

    }

    function calc_skill_pairs_needs(skill_needs, skill_pairs) {
      let needs = []
      for (let pair of skill_pairs) {
        need = calc_skill_needs(skill_needs, pair)
        needs.push(need)
      }
      return needs.reduce(push_items_together)
    }

    function calc_skill_needs(skill_needs, skill_pair) {
      let [low, high] = skill_pair
      low = Number(low)
      high = Number(high)
      let result = []
      for (let i = low-1; i <= high-2; i++) {
        result = push_items_together(result ,skill_needs[i])
      }
      return result
    }
    // item: [id, name, num]
    function push_items_together(items_1, items_2) {
      if (items_1.length !== 0 && items_2.length === 0) {
        return push_items_together(items_2, items_1)
      } 
      let result = JSON.parse(JSON.stringify(items_2))
      outer:
      for (let j = 0; j < items_1.length; j++) {
        //console.log('j:' + j)
        for (let i = 0; i < result.length; i++) {
          //console.log('i:' + i)
          //console.log(result.length)
          if (items_1[j][0] === result[i][0]) {
            result[i][2] += items_1[j][2]
            continue outer;
          } else if (i === result.length - 1) {
            result.push(items_1[j])
            break;
          }
        }
      }

      return result
    }



    function activate_tab() {
      let cur_tab = $('.nav-tab.servant')
      cur_tab.addClass('active')
    }

    function bind_summation(){
      let heads = $('.flex-item.head a')
      let tbody = $('.tbl_servant tbody')
      let url = './static/json/about_ids_names/servant_ids_by_star.json'
      $.getJSON(url, function(data){
        for (let i = 0; i < heads.length; i++) {
          $(heads[i]).on('click', function(){
            let data_num = this.getAttribute('data_num')
            //console.log(data)

            let tr = $(`<tr data_num="${data_num}"></tr>`)

            let td_1 = $(`<td><img src="http://file.fgowiki.fgowiki.com/fgo/head/${data_num}.jpg" class="thumb servant"></td>`)

            let td_2 = $(`<td></td>`)

            let td_2_input_1 = $(`<input type="number" value="1" class="servant_lv from_lv" data-type="from_lv" min="1" max="90">`)

            let td_2_glyphicon = $(`<span class="glyphicon glyphicon-play" aria-hidden="true" style="margin: 0 2px 0 1px; left: 0"></span>`)

            let td_2_input_2 = $(`<input type="number" value="" class="servant_lv to_lv" data-type="to_lv" min="1" max="90" data-star=0><br>`)
            if (data[0].indexOf(data_num) !== -1) {
              td_2_input_2.val(65)
              td_2_input_2.attr('data-star', 0)
            } else if (data[1].indexOf(data_num) !== -1) {
              td_2_input_2.val(60)
              td_2_input_2.attr('data-star', 1)
            } else if (data[2].indexOf(data_num) !== -1) {
              td_2_input_2.val(65)
              td_2_input_2.attr('data-star', 2)
            } else if (data[3].indexOf(data_num) !== -1) {
              td_2_input_2.val(70)
              td_2_input_2.attr('data-star', 3)
            } else if (data[4].indexOf(data_num) !== -1) {
              td_2_input_2.val(80)
              td_2_input_2.attr('data-star', 4)
            } else if (data[5].indexOf(data_num) !== -1) {
              td_2_input_2.val(90)
              td_2_input_2.attr('data-star', 5)
            }

            let td_2_checkbox = $(`<label>broken
                <input type="checkbox" style="position: relative; top: 3px;">   
              </label>`)

            let td_2_div = $(`<div class="level-input"></div>`)
            td_2_div.append(td_2_input_1)
                    .append(td_2_glyphicon)
                    .append(td_2_input_2)
                    .append(td_2_checkbox)

            
            td_2.append(td_2_div)


            let td_3 = $(`<td></td>`)

            for (let i = 1; i <= 3; i++) {
              let td_3_skill_group = $(`<div class="skill-group"></div`)

              let td_3_skill_info = $(`<div class="skill-info">
                <img src="#" id="skill${i}" class="skill thumb">
                <span class="skill_name"></span>
              </div>`)

              let td_3_skill_input = $(`<div class="skill-input">
                <input type="number" value="1" class="skill_lv from_skill_lv" data-type="from_skill_lv_1" min="1" max="10">
                <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
                <input type="number" value="10" class="skill_lv to_skill_lv" data-type="to_skill_lv_1" min="1" max="10">
              </div>`)

              td_3_skill_group.append(td_3_skill_info)
                              .append(td_3_skill_input)

              td_3.append(td_3_skill_group)

            }

            let td_4 = $(`<td></td>`)

            let td_4_delete_btn = $(`<button type="button" class="btn btn-danger delete">Delete</button>`)

            td_4_delete_btn.on('click', function(){
              let tr = $(this).parent().parent()
              let data_num = tr.attr('data_num')
              tr.remove()
              let head = $(`.flex-item.head a[data_num='${data_num}']`);
              head.show()
            })

            td_4.append(td_4_delete_btn)


            tr.append(td_1)
              .append(td_2)
              .append(td_3)
              .append(td_4)

            tbody.append(tr)

            tr.find(`input[type='checkbox']`).on('change', function(){
              $(this).toggleClass('checked')
            })

            tr.find(`input[type='number']`).on('focus', function(){
              $(this).select()
            })

            let url = './static/json/extra/skill/skill_names_compl.json'
            $.getJSON(url, function(data){
                let id = Number(data_num) - 1
                let [skill_names, img_names] = data[id]

                imgs = $(`tr[data_num='${data_num}'] td:eq(2) img`)
                spans = $(`tr[data_num='${data_num}'] td:eq(2) span.skill_name`)
                for (let i = 0; i < imgs.length; i++) {
                  $(imgs[i]).attr('src', `http://file.fgowiki.fgowiki.com/mobile/images/Skill/${img_names[i]}.png`)
                  $(spans[i]).text(skill_names[i])
                }

            })


            //let tr = $(`tr[data_num='${data_num}']`)
            //tr.css('display', 'table-row')
            //tr.attr('data-calc', true)
            $(this).hide()
          })
        }
      })

    }

    function pad(num, n) {  
      let len = num.toString().length;  
      while(len < n) {  
          num = "0" + num;  
          len++;  
      }  
      return num;  
    }  

    function pad_char(num, n, char, direction) {  
      let len = num.toString().length * 4.3;  
      if (direction === 'left') {
        while(len < n) {  
          num = char + num;  
          len++;  
        }    
      } else {
        while(len < n) {  
          num = num + char;  
          len++;  
        }    
      }
      return num;  
    }  



  </script>


  

</body>
</html>
